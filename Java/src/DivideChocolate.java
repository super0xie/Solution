
public class DivideChocolate {
	
	public int maximizeSweetnessTLE(int[] sweetness, int K) {
        int[][] dp = new int[sweetness.length][K+1];
        
        int sum = 0;
        for(int i = 0; i < sweetness.length; i++) {
        	sum += sweetness[i];
        	dp[i][0] = sum;
        }
        
        for(int i = 0; i < sweetness.length; i++) {
        	for(int j = 1; j < K+1; j++) {
        		sum = 0;
        		if(i < j) break;
        		for(int k = i; k > 0; k--) {
        			sum += sweetness[k];
        			dp[i][j] = Math.max(dp[i][j], Math.min(dp[k-1][j-1], sum));
        		}
        	}
        }
        
        return dp[sweetness.length-1][K];
    }
	
	public int maximizeSweetness(int[] sweetness, int K) {
		int l = 1;
		int r = 1000000000;
		
		while(l < r) {
			int mid = l + (r-l+1)/2;
			
			int cur = 0;
			int count = 0;
			
			for(int i = 0; i < sweetness.length; i++) {
				cur += sweetness[i];
				if(cur >= mid) {
					cur = 0;
					count++;
					
					if(count > K) break;
				}
			}
			
			if(count > K) l = mid;
			else r = mid - 1;
			
			
		}
		
		return l;
    }
	
	public static void main(String[] args) {
		int[] sweetness = {36454,22540,44650,26826,46522,14764,10456,31263,343,7533,40130,52402,88318,77382,45097,66479,25,1051,92036,73242,36459,20352,50192,34490,80900,32870,7637,79449,64021,6047,62154,505,14905,79427,17445,6455,22045,56198,643,53824,65788,80121,62287,77478,34553,67996,20343,25015,50825,10688,51639,46045,55796,72164,19909,86595,4841,7735,46496,4094,99744,43960,2385,92117,56268,87082,10836,19288,57780,12570,16502,57783,25519,99115,81756,69672,85420,65025,2773,10558,9166,26037,9270,59766,5624,45384,96177,91220,47809,37402,23513,55636,57635,69690,76073,56773,54400,89656,7271,351,74356,78534,16279,27969,54705,44782,32319,56788,82362,74999,1989,20815,68092,53083,87056,13173,45313,91786,19852,28652,76923,16580,12678,25049,11996,52148,61359,17041,44875,95370,29677,36089,24833,7158,75718,43369,69757,96430,17049,3685,34817,23905,70296,30655,40586,44942,42021,91097,52884,19565,18432,41628,47923,87176,33753,93501,34150,42498,21697,50386,38817,96322,35679,8638,84863,67012,66013,95149,20941,47988,94561,67451,42160,66656,51431,56151,82488,19600,70767,50489,49914,56735,58130,46362,26372,6001,9833,39639,8409,66679,96910,76559,61018,76743,67708,59444,63523,93116,43166,42640,13235,82984,97522,55084,93363,66571,98792,30269,67200,58242,91917,51143,82850,86086,82148,55301,32837,66137,31560,45528,91217,16285,58443,87594,72191,50869,8910,4961,82903,42307,85670,44261,87081,2122,29568,58655,636,30300,68910,80448,76865,67302,63508,12850,8899,61633,48055,24141,20713,56071,43455,42676,77867,62090,24930,88410,86103,18205,34540,94173,64472,71488,94815,64207,22000,46917,31772,24704,65644,86748,56637,72055,58161,76784,20476,75221,46801,6844,24946,65449,34537,85313,30712,14489,39692,80200,15427,39828,51803,72514,4438,86689,71092,52086,87259,4586,13662,52086,19026,76899,8604,11413,88527,80034,21478,77512,26426,29567,78125,59725,51360,99838,10815,83521,98827,5986,59663,10950,52129,95901,31940,98376,96169,94748,69664,44356,28728,42469,11630,44082,97662,13696,81269,62778,52683,73140,29121,37416,45287,39839,90706,44001,837,75630,28630,77390,74576,31973,15992,66088,73814,55637,90006,1487,58142,25660,65450,1855,63030,66283,79772,4535,35746,27862,94663,17884,92783,69021,17258,59917,80405,39925,26982,16065,16302,72764,70237,44525,93821,7990,56548,19903,36015,56392,71808,73902,10995,16804,29242,31758,36314,52435,91999,92009,81012,76555,99394,42936,91228,74466,46406,42820,38038,65151,55880,65377,89392,35670,14666,74956,35535,53962,71194,90406,54499,31568,90257,1275,5808,53401,7318,97247,97350,42386,14970,21232,98386,17043,58830,80121,87023,16598,26203,20950,5247,3978,65343,81552,38153,99074,9255,54013,6845,74411,11110,91289,514,28247,58708,79735,48726,27702,13386,87769,8949,85436,77196,54154,76063,90385,28211,39044,47894,63053,96092,79149,87846,98496,44211,20170,25472,44460,33428,76959,72342,88079,27330,31573,50118,61174,89561,71403,26506,54191,89211,24479,16398,33447,7176,75050,97293,43063,37151,46799,48941,62452,90516,66105,88654,37620,74422,39899,90378,28334,69750,31565,95967,62916,53328,52508,62466,49415,52004,80133,67871,62406,54193,71220,5949,90510,11034,66769,91956,72232,45441,78915,81410,69928,7496,17812,44607,31142,16616,7184,12833,81576,12933,41195,44079,14888,85846,54850,9426,22659,2130,29187,1592,60542,33565,13802,82981,15947,69719,11009,17135,41935,34140,36689,66722,76338,99767,45302,94882,13862,27013,69067,31857,76663,58101,44133,52303,25241,47797,38906,155,37252,14123,78309,23804,12330,42352,85852,46584,36971,35753,96184,13688,52978,49574,89457,63282,48703,59312,40914,12743,80184,96344,82963,80398,27397,36063,4120,23132,20536,92408,62763,52,52435,2272,19060,27039,45717,86915,63096,48176,50163,60851,82131,40485,37339,20509,35164,86344,56422,76146,63174,39933,45811,83676,74929,71195,45888,93894,82307,22322,62532,10619,35681,57774,86988,74517,50664,24504,11998,77236,52628,42358,37565,52376,32899,30156,2415,71731,89142,62005,47516,93693,15726,56493,8780,29821,68883,48984,67383,90110,66901,82291,13183,51949,58925,95237,12215,87563,78933,1671,54270,3962,41868,76081,11523,19202,21106,50957,81535,37276,36308,40540,60123,1550,60342,17155,7631,19547,75529,44939,71181,562,18668,95879,88348,45777,9251,63992,81161,22403,29287,72450,31070,40843,76281,96345,69141,84603,58185,707,59771,73865,97060,22125,18411,63666,77916,76369,96389,42642,87674,45871,86730,99244,77363,61425,72953,81042,61308,27539,58441,27461,44653,4777,90192,44318,53534,94812,82371,48478,49950,45159,67937,77519,35783,13251,65948,82105,27998,49351,28474,78472,34229,13058,88047,40790,20164,86670,81274,35629,59753,21910,21024,17012,90660,66367,80441,23706,67913,90433,50519,7672,73686,6137,73993,66704,28177,907,82386,55499,2533,179,61364,65822,36135,30233,38879,50778,28442,87854,70116,35295,90364,70481,67936,33512,3978,90422,80530,7211,7268,83207,34765,35768,63666,60723,79140,76354,58550,22702,2490,1011,26640,47859,46139,33452,65056,16665,51857,31438,53459,81418,42257,55300,99789,88074,60309,24878,63488,40323,93165,8547,81470,13939,29886,90353,96145,3438,76710,83855,43569,9037,76403,31439,17638,97232,9727,3606,74772,93139,14572,94787,69127,20184,82274,7582,32422,46806,32681,81734,79603,61753,801,61568,37350,84763,10559,74359,20244,73817,32903,68977,88498,17351,91185,53560,5608,61225,60653,87738,22280,62799,7053,2986,70786,42571,67375,5190,5047,82060,69775,4391,12531,23396,11915,50031,90393,37583,75197,10196,14609,24686,67216,16423,2204,88477,83861,66721,31434,38619,23833,59643,83434,42695,50918,55889,41819,56487,18658,98211,22078,87697,35867,3750,16957,90403,63481,76122,86662,4183,59386,41816,59490,75903,27553,61733,9467,33351,63437,82237,77119,29444,26124,28134,20392,46685,42949,82092,76933,43191,89535,34989,81899,53977,33565,27932,2773,57390,27747,75241,52815,6540,4459,43097,23402,96423,37873,17725,37427,36085,37111,71366,8999,34756,762,5459,13218,51507,16795,41453,56342,72260,10819,20022,24929,64214,23399,12081,71363,77170,32390,3559,2289,56118,45350,78951,20369,86057,44738,44580,5190,12452,60388,64781,36516,59212,35896,1241,7969,32679,86559,2673,73842,95682,21542,92289,74102,4825,90362,88260,64024,63798,62960,39095,57355,4972,42589,51378,71994,57243,26966,71928,77918,24115,27479,8827,70185,80509,94268,12521,57850,92946,6828,4387,58587,11968,89356,15144,23590,99673,92528,99137,93537,77768,13127,34490,88699,4977,7905,41150,91841,97474,10669,16485,4566,45309,42690,22848,56746,95532,4869,47324,71844,39420,1234,17057,98477,78719,16184,28078,85022,19586,84914,58617,1123,16216,54456,48648,35284,4466,84045,40974,99893,20,30164,22813,70067,67675,5450,58289,24457,12997,1234,96236,15359,65402,24009,85897,57619,27914,45833,35247,1527,73995,45749,91088,20166,74467,22768,84640,38959,20783,80153,37938,87838,52910,49765,36677,28887,21357,31216,28357,1253,77252,36205,8527,50642,41149,81164,95503,13750,10070,32495,11016,13542,70999,18294,43622,58568,39782,46912,38908,65712,29788,57378,80532,80422,92589,65134,62139,79073,49380,77783,20572,53713,40717,29012,72859,68420,10834,72431,4712,18938,75522,66144,14603,82990,22992,9066,86995,89102,41757,74686,9440,40106,94536,60094,7127,68705,38339,14780,93609,46256,87083,96092,81421,48079,59671,56096,36663,48667,2773,36125,1962,46016,93776,39370,28896,28952,15508,93984,43459,70819,46065,33581,50286,25170,62195,30470,13765,69086,32108,47289,63890,18301,20425,53777,82243,48344,34980,31478,69307,93370,29687,8025,30498,7339,33667,17244,18703,30070,53287,20675,6213,28254,86926,43595,77284,45304,32505,27333,27792,56073,64739,77839,24513,55967,70310,8764,67345,71577,27342,16576,78460,47581,7371,71200,19870,52054,76197,21103,27742,63146,24063,57392,43496,1232,91669,62084,42101,35180,68268,89902,68061,36507,22291,10945,53439,92513,63014,38267,49576,26599,31292,9326,74114,69113,70907,96454,95817,48830,99157,24634,14230,32946,50151,91963,33996,66084,88905,10672,19370,51577,34064,96723,18992,53765,62888,60648,37120,64202,62905,66950,20063,13334,56904,1025,46617,66889,49878,34663,45009,7409,18888,68996,35966,81142,21519,24211,28463,18672,85212,16115,91433,33119,51477,36317,4567,12150,27192,93390,28809,83671,83092,81064,60135,6912,65994,16841,81000,37374,81840,64348,67431,73962,5603,49268,80320,31944,62233,28671,35863,77888,64075,35135,39852,2812,25030,14245,10175,82542,61203,75641,16716,90749,8038,32881,1659,66734,38261,94087,67712,21622,28438,9149,90471,16547,69932,99356,74531,64891,97221,18261,64684,8690,70682,48136,6549,39948,67916,30470,31429,30730,27788,42857,68646,1620,66305,44567,98255,88675,4826,90284,18449,51210,33929,38968,58829,86883,22228,25476,46289,83305,96751,40664,16895,11357,11465,2106,28033,18653,17578,60600,82628,66635,40740,52919,52172,8197,9243,87363,57935,36411,54456,94853,83359,94302,52515,28182,84767,14658,14133,17072,71447,74828,14626,39623,20525,74342,46639,94568,86988,72618,52688,43026,60118,65762,90436,7139,35235,37299,56734,51614,79007,53531,88224,36222,8920,80489,37134,75040,43505,43731,72081,27306,69220,94678,18553,35301,6795,76608,57374,60371,67876,64572,23838,19201,24666,4193,4718,11851,42341,17475,38946,34174,11579,68429,4275,61952,34405,98625,49437,35696,99812,51113,39741,92138,49256,69367,22012,61639,35484,59770,51739,81869,96190,52113,25740,4516,83176,29679,73552,94364,69869,98471,76904,44871,76452,45884,20720,16836,71142,30491,23100,46641,83693,8433,82228,42189,61175,6198,4638,68316,75329,43331,84337,61278,44229,42639,2297,1435,77180,6637,23179,302,62526,76597,79061,6204,25945,78716,40266,96577,21454,8679,31626,86529,7105,70191,161,80759,18221,17522,56979,52299,98521,84720,91522,54029,77215,68443,94984,80588,16264,55185,38791,38835,39159,22633,92372,5305,10428,8934,83783,38615,47070,44119,9899,29026,4508,47531,18874,85914,83460,58816,81545,21644,51216,39119,34573,38024,84186,46503,73366,49091,13066,43320,64616,82755,81323,88060,27492,31792,88043,5288,8859,63386,55275,18737,82207,83629,77894,43079,43626,65492,13468,54543,80549,29046,45710,42400,56321,70772,60332,55926,23484,86742,365,72278,5510,66911,5513,50283,28163,67168,58398,52953,95361,70632,23178,32912,96032,67600,39294,46609,83120,64334,85329,62974,99407,48042,48050,45178,45782,73919,47990,1482,87358,82873,40731,28185,34376,76061,79880,42387,90765,21281,46788,96805,48317,30511,47573,98128,55296,32255,27201,57630,48335,18836,51296,22267,8892,99270,77810,7746,57421,16727,42203,10362,39292,75068,27582,37388,88442,55193,29062,33246,75519,52100,66472,33811,17097,73056,80347,30526,81448,49580,67342,56783,80382,50720,11673,40052,99015,36142,21103,90524,85049,42998,431,75784,97934,84170,85711,93346,5496,659,32319,61185,46664,14883,61840,97368,34469,75695,78446,18524,8165,71544,91407,36509,68275,89997,19542,16849,68096,92898,60094,87351,18025,85348,88729,38796,96589,94440,67968,30330,39432,53103,69900,89886,35618,45093,91978,86951,83916,56866,31086,87542,22843,69558,84879,85024,56484,19986,18806,27825,77268,32370,87135,47037,49473,76506,36341,43101,87734,45803,85211,65883,73691,837,95561,64897,26094,4578,99668,19391,22849,15838,32106,53496,92262,15688,67871,85254,16697,24139,90563,27076,28178,8014,72879,58307,48978,59524,24711,77570,45965,5852,97431,17574,43424,44691,47704,85954,50074,29329,65921,24957,24422,14951,61787,22998,69989,51542,55653,73467,11343,91875,99908,44149,17576,49574,33196,72960,90895,15241,62126,70162,25944,97147,32361,13639,31293,7270,12710,41127,96699,30573,95336,7369,73638,11317,73446,94830,46530,59352,47387,75887,91781,14917,99503,66344,34572,36382,71814,47867,91135,2898,91649,93799,92357,74707,73619,7720,10583,33376,41252,5320,77599,97293,7777,83469,99036,2534,29331,1945,10567,26749,23345,10640,83935,6216,26164,45895,17411,2734,64195,31607,57688,96644,76446,46149,54025,28599,64190,81645,94433,20114,16148,18283,92602,61149,24267,30647,14456,3273,27248,73928,80536,33946,70358,94224,24316,8451,97478,38175,7981,33965,50947,89394,29914,8875,4133,84714,42323,78557,32303,62255,76887,25615,8994,9966,44452,78087};
		System.out.println(sweetness.length);
		DivideChocolate test = new DivideChocolate();
		System.out.println(test.maximizeSweetness(sweetness, 1079));
	}
	
}
